{"ast":null,"code":"import _slicedToArray from\"/home/divyanshu/nodejs/instagram/server/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect,useContext}from'react';import{UserContext}from'../../App';import{Link}from'react-router-dom';var Home=function Home(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),data=_useState2[0],setData=_useState2[1];var _useContext=useContext(UserContext),state=_useContext.state,dispatch=_useContext.dispatch;useEffect(function(){fetch('/allpost',{headers:{\"Authorization\":\"Bearer \"+localStorage.getItem(\"jwt\")}}).then(function(res){return res.json();}).then(function(result){console.log(result);setData(result.posts);});},[]);var likePost=function likePost(id){fetch('/like',{method:\"put\",headers:{\"Content-Type\":\"application/json\",\"Authorization\":\"Bearer \"+localStorage.getItem(\"jwt\")},body:JSON.stringify({postId:id})}).then(function(res){return res.json();}).then(function(result){//   console.log(result)\nvar newData=data.map(function(item){if(item._id==result._id){return result;}else{return item;}});setData(newData);}).catch(function(err){console.log(err);});};var unlikePost=function unlikePost(id){fetch('/unlike',{method:\"put\",headers:{\"Content-Type\":\"application/json\",\"Authorization\":\"Bearer \"+localStorage.getItem(\"jwt\")},body:JSON.stringify({postId:id})}).then(function(res){return res.json();}).then(function(result){//   console.log(result)\nvar newData=data.map(function(item){if(item._id==result._id){return result;}else{return item;}});setData(newData);}).catch(function(err){console.log(err);});};var makeComment=function makeComment(text,postId){fetch('/comment',{method:\"put\",headers:{\"Content-Type\":\"application/json\",\"Authorization\":\"Bearer \"+localStorage.getItem(\"jwt\")},body:JSON.stringify({postId:postId,text:text})}).then(function(res){return res.json();}).then(function(result){console.log(result);var newData=data.map(function(item){if(item._id==result._id){return result;}else{return item;}});setData(newData);}).catch(function(err){console.log(err);});};var deletePost=function deletePost(postid){fetch(\"/deletepost/\".concat(postid),{method:\"delete\",headers:{Authorization:\"Bearer \"+localStorage.getItem(\"jwt\")}}).then(function(res){return res.json();}).then(function(result){console.log(result);var newData=data.filter(function(item){return item._id!==result._id;});setData(newData);});};return/*#__PURE__*/React.createElement(\"div\",{className:\"home\"},data.map(function(item){return/*#__PURE__*/React.createElement(\"div\",{className:\"card home-card\",key:item._id},/*#__PURE__*/React.createElement(\"h5\",{style:{padding:\"5px\"}},/*#__PURE__*/React.createElement(Link,{to:item.postedBy._id!==state._id?\"/profile/\"+item.postedBy._id:\"/profile\"},item.postedBy.name),\" \",item.postedBy._id==state._id&&/*#__PURE__*/React.createElement(\"i\",{className:\"material-icons\",style:{float:\"right\"},onClick:function onClick(){return deletePost(item._id);}},\"delete\")),/*#__PURE__*/React.createElement(\"div\",{className:\"card-image\"},/*#__PURE__*/React.createElement(\"img\",{src:item.photo})),/*#__PURE__*/React.createElement(\"div\",{className:\"card-content\"},/*#__PURE__*/React.createElement(\"i\",{className:\"material-icons\",style:{color:\"red\"}},\"favorite\"),item.likes.includes(state._id)?/*#__PURE__*/React.createElement(\"i\",{className:\"material-icons\",onClick:function onClick(){unlikePost(item._id);}},\"thumb_down\"):/*#__PURE__*/React.createElement(\"i\",{className:\"material-icons\",onClick:function onClick(){likePost(item._id);}},\"thumb_up\"),/*#__PURE__*/React.createElement(\"h6\",null,item.likes.length,\" likes\"),/*#__PURE__*/React.createElement(\"h6\",null,item.title),/*#__PURE__*/React.createElement(\"p\",null,item.body),item.comments.map(function(record){return/*#__PURE__*/React.createElement(\"h6\",{key:record._id},/*#__PURE__*/React.createElement(\"span\",{style:{fontWeight:\"500\"}},record.postedBy.name),\" \",record.text);}),/*#__PURE__*/React.createElement(\"form\",{onSubmit:function onSubmit(e){e.preventDefault();makeComment(e.target[0].value,item._id);}},/*#__PURE__*/React.createElement(\"input\",{type:\"text\",placeholder:\"add a comment\"}))));}));};export default Home;","map":{"version":3,"sources":["/home/divyanshu/nodejs/instagram/server/client/src/components/screens/Home.js"],"names":["React","useState","useEffect","useContext","UserContext","Link","Home","data","setData","state","dispatch","fetch","headers","localStorage","getItem","then","res","json","result","console","log","posts","likePost","id","method","body","JSON","stringify","postId","newData","map","item","_id","catch","err","unlikePost","makeComment","text","deletePost","postid","Authorization","filter","padding","postedBy","name","float","photo","color","likes","includes","length","title","comments","record","fontWeight","e","preventDefault","target","value"],"mappings":"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","sourcesContent":["import React,{useState,useEffect,useContext} from 'react'\nimport {UserContext} from '../../App'\nimport {Link} from 'react-router-dom'\nconst Home  = ()=>{\n    const [data,setData] = useState([])\n    const {state,dispatch} = useContext(UserContext)\n    useEffect(()=>{\n       fetch('/allpost',{\n           headers:{\n               \"Authorization\":\"Bearer \"+localStorage.getItem(\"jwt\")\n           }\n       }).then(res=>res.json())\n       .then(result=>{\n           console.log(result)\n           setData(result.posts)\n       })\n    },[])\n\n    const likePost = (id)=>{\n          fetch('/like',{\n              method:\"put\",\n              headers:{\n                  \"Content-Type\":\"application/json\",\n                  \"Authorization\":\"Bearer \"+localStorage.getItem(\"jwt\")\n              },\n              body:JSON.stringify({\n                  postId:id\n              })\n          }).then(res=>res.json())\n          .then(result=>{\n                   //   console.log(result)\n            const newData = data.map(item=>{\n                if(item._id==result._id){\n                    return result\n                }else{\n                    return item\n                }\n            })\n            setData(newData)\n          }).catch(err=>{\n              console.log(err)\n          })\n    }\n    const unlikePost = (id)=>{\n          fetch('/unlike',{\n              method:\"put\",\n              headers:{\n                  \"Content-Type\":\"application/json\",\n                  \"Authorization\":\"Bearer \"+localStorage.getItem(\"jwt\")\n              },\n              body:JSON.stringify({\n                  postId:id\n              })\n          }).then(res=>res.json())\n          .then(result=>{\n            //   console.log(result)\n            const newData = data.map(item=>{\n                if(item._id==result._id){\n                    return result\n                }else{\n                    return item\n                }\n            })\n            setData(newData)\n          }).catch(err=>{\n            console.log(err)\n        })\n    }\n\n    const makeComment = (text,postId)=>{\n          fetch('/comment',{\n              method:\"put\",\n              headers:{\n                  \"Content-Type\":\"application/json\",\n                  \"Authorization\":\"Bearer \"+localStorage.getItem(\"jwt\")\n              },\n              body:JSON.stringify({\n                  postId,\n                  text\n              })\n          }).then(res=>res.json())\n          .then(result=>{\n              console.log(result)\n              const newData = data.map(item=>{\n                if(item._id==result._id){\n                    return result\n                }else{\n                    return item\n                }\n             })\n            setData(newData)\n          }).catch(err=>{\n              console.log(err)\n          })\n    }\n\n    const deletePost = (postid)=>{\n        fetch(`/deletepost/${postid}`,{\n            method:\"delete\",\n            headers:{\n                Authorization:\"Bearer \"+localStorage.getItem(\"jwt\")\n            }\n        }).then(res=>res.json())\n        .then(result=>{\n            console.log(result)\n            const newData = data.filter(item=>{\n                return item._id !== result._id\n            })\n            setData(newData)\n        })\n    }\n   return (\n       <div className=\"home\">\n           {\n               data.map(item=>{\n                   return(\n                       <div className=\"card home-card\" key={item._id}>\n                            <h5 style={{padding:\"5px\"}}><Link to={item.postedBy._id !== state._id?\"/profile/\"+item.postedBy._id :\"/profile\"  }>{item.postedBy.name}</Link> {item.postedBy._id == state._id \n                            && <i className=\"material-icons\" style={{\n                                float:\"right\"\n                            }} \n                            onClick={()=>deletePost(item._id)}\n                            >delete</i>\n\n                            }</h5>\n                            <div className=\"card-image\">\n                                <img src={item.photo}/>\n                            </div>\n                            <div className=\"card-content\">\n                            <i className=\"material-icons\" style={{color:\"red\"}}>favorite</i>\n                            {item.likes.includes(state._id)\n                            ? \n                             <i className=\"material-icons\"\n                                    onClick={()=>{unlikePost(item._id)}}\n                              >thumb_down</i>\n                            : \n                            <i className=\"material-icons\"\n                            onClick={()=>{likePost(item._id)}}\n                            >thumb_up</i>\n                            }\n                            \n                           \n                                <h6>{item.likes.length} likes</h6>\n                                <h6>{item.title}</h6>\n                                <p>{item.body}</p>\n                                {\n                                    item.comments.map(record=>{\n                                        return(\n                                        <h6 key={record._id}><span style={{fontWeight:\"500\"}}>{record.postedBy.name}</span> {record.text}</h6>\n                                        )\n                                    })\n                                }\n                                <form onSubmit={(e)=>{\n                                    e.preventDefault()\n                                    makeComment(e.target[0].value,item._id)\n                                }}>\n                                  <input type=\"text\" placeholder=\"add a comment\" />  \n                                </form>\n                                \n                            </div>\n                        </div> \n                   )\n               })\n           }\n          \n          \n       </div>\n   )\n}\n\n\nexport default Home"]},"metadata":{},"sourceType":"module"}
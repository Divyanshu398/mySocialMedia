{"ast":null,"code":"import _toConsumableArray from\"/home/divyanshu/nodejs/instagram/server/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _objectSpread from\"/home/divyanshu/nodejs/instagram/server/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/home/divyanshu/nodejs/instagram/server/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState,useContext}from'react';import{UserContext}from'../../App';import{useParams}from'react-router-dom';var Profile=function Profile(){var _useState=useState(null),_useState2=_slicedToArray(_useState,2),userProfile=_useState2[0],setProfile=_useState2[1];var _useContext=useContext(UserContext),state=_useContext.state,dispatch=_useContext.dispatch;var _useParams=useParams(),userid=_useParams.userid;var _useState3=useState(state?!state.following.includes(userid):true),_useState4=_slicedToArray(_useState3,2),showfollow=_useState4[0],setShowFollow=_useState4[1];useEffect(function(){fetch(\"/user/\".concat(userid),{headers:{\"Authorization\":\"Bearer \"+localStorage.getItem(\"jwt\")}}).then(function(res){return res.json();}).then(function(result){//console.log(result)\nsetProfile(result);});},[]);var followUser=function followUser(){fetch('/follow',{method:\"put\",headers:{\"Content-Type\":\"application/json\",\"Authorization\":\"Bearer \"+localStorage.getItem('jwt')},body:JSON.stringify({followId:userid})}).then(function(res){return res.json();}).then(function(data){dispatch({type:\"UPDATE\",payload:{following:data.following,followers:data.followers}});localStorage.setItem(\"user\",JSON.stringify(data));setProfile(function(prevState){return _objectSpread({},prevState,{user:_objectSpread({},prevState.user,{followers:[].concat(_toConsumableArray(prevState.user.followers),[data._id])})});});setShowFollow(false);});};var unfollowUser=function unfollowUser(){fetch('/unfollow',{method:\"put\",headers:{\"Content-Type\":\"application/json\",\"Authorization\":\"Bearer \"+localStorage.getItem('jwt')},body:JSON.stringify({unfollowId:userid})}).then(function(res){return res.json();}).then(function(data){dispatch({type:\"UPDATE\",payload:{following:data.following,followers:data.followers}});localStorage.setItem(\"user\",JSON.stringify(data));setProfile(function(prevState){var newFollower=prevState.user.followers.filter(function(item){return item!=data._id;});return _objectSpread({},prevState,{user:_objectSpread({},prevState.user,{followers:newFollower})});});setShowFollow(true);});};return/*#__PURE__*/React.createElement(React.Fragment,null,userProfile?/*#__PURE__*/React.createElement(\"div\",{style:{maxWidth:\"550px\",margin:\"0px auto\"}},/*#__PURE__*/React.createElement(\"div\",{style:{display:\"flex\",justifyContent:\"space-around\",margin:\"18px 0px\",borderBottom:\"1px solid grey\"}},/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"img\",{style:{width:\"160px\",height:\"160px\",borderRadius:\"80px\"},src:userProfile.user.pic})),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"h4\",null,userProfile.user.name),/*#__PURE__*/React.createElement(\"h5\",null,userProfile.user.email),/*#__PURE__*/React.createElement(\"div\",{style:{display:\"flex\",justifyContent:\"space-between\",width:\"108%\"}},/*#__PURE__*/React.createElement(\"h6\",null,userProfile.posts.length,\" posts\"),/*#__PURE__*/React.createElement(\"h6\",null,userProfile.user.followers.length,\" followers\"),/*#__PURE__*/React.createElement(\"h6\",null,userProfile.user.following.length,\" following\")),showfollow?/*#__PURE__*/React.createElement(\"button\",{style:{margin:\"10px\"},className:\"btn waves-effect waves-light #64b5f6 blue darken-1\",onClick:function onClick(){return followUser();}},\"Follow\"):/*#__PURE__*/React.createElement(\"button\",{style:{margin:\"10px\"},className:\"btn waves-effect waves-light #64b5f6 blue darken-1\",onClick:function onClick(){return unfollowUser();}},\"UnFollow\"))),/*#__PURE__*/React.createElement(\"div\",{className:\"gallery\"},userProfile.posts.map(function(item){return/*#__PURE__*/React.createElement(\"img\",{key:item._id,className:\"item\",src:item.photo,alt:item.title});}))):/*#__PURE__*/React.createElement(\"h2\",null,\"loading...!\"));};export default Profile;","map":{"version":3,"sources":["/home/divyanshu/nodejs/instagram/server/client/src/components/screens/UserProfile.js"],"names":["React","useEffect","useState","useContext","UserContext","useParams","Profile","userProfile","setProfile","state","dispatch","userid","following","includes","showfollow","setShowFollow","fetch","headers","localStorage","getItem","then","res","json","result","followUser","method","body","JSON","stringify","followId","data","type","payload","followers","setItem","prevState","user","_id","unfollowUser","unfollowId","newFollower","filter","item","maxWidth","margin","display","justifyContent","borderBottom","width","height","borderRadius","pic","name","email","posts","length","map","photo","title"],"mappings":"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","sourcesContent":["import React,{useEffect,useState,useContext} from 'react'\nimport {UserContext} from '../../App'\nimport {useParams} from 'react-router-dom'\nconst Profile  = ()=>{\n    const [userProfile,setProfile] = useState(null)\n    \n    const {state,dispatch} = useContext(UserContext)\n    const {userid} = useParams()\n    const [showfollow,setShowFollow] = useState(state?!state.following.includes(userid):true)\n    useEffect(()=>{\n       fetch(`/user/${userid}`,{\n           headers:{\n               \"Authorization\":\"Bearer \"+localStorage.getItem(\"jwt\")\n           }\n       }).then(res=>res.json())\n       .then(result=>{\n           //console.log(result)\n         \n            setProfile(result)\n       })\n    },[])\n\n\n    const followUser = ()=>{\n        fetch('/follow',{\n            method:\"put\",\n            headers:{\n                \"Content-Type\":\"application/json\",\n                \"Authorization\":\"Bearer \"+localStorage.getItem('jwt')\n            },\n            body:JSON.stringify({\n                followId:userid\n            })\n        }).then(res=>res.json())\n        .then(data=>{\n        \n            dispatch({type:\"UPDATE\",payload:{following:data.following,followers:data.followers}})\n             localStorage.setItem(\"user\",JSON.stringify(data))\n             setProfile((prevState)=>{\n                 return {\n                     ...prevState,\n                     user:{\n                         ...prevState.user,\n                         followers:[...prevState.user.followers,data._id]\n                        }\n                 }\n             })\n             setShowFollow(false)\n        })\n    }\n    const unfollowUser = ()=>{\n        fetch('/unfollow',{\n            method:\"put\",\n            headers:{\n                \"Content-Type\":\"application/json\",\n                \"Authorization\":\"Bearer \"+localStorage.getItem('jwt')\n            },\n            body:JSON.stringify({\n                unfollowId:userid\n            })\n        }).then(res=>res.json())\n        .then(data=>{\n            \n            dispatch({type:\"UPDATE\",payload:{following:data.following,followers:data.followers}})\n             localStorage.setItem(\"user\",JSON.stringify(data))\n            \n             setProfile((prevState)=>{\n                const newFollower = prevState.user.followers.filter(item=>item != data._id )\n                 return {\n                     ...prevState,\n                     user:{\n                         ...prevState.user,\n                         followers:newFollower\n                        }\n                 }\n             })\n             setShowFollow(true)\n             \n        })\n    }\n   return (\n       <>\n       {userProfile ?\n       <div style={{maxWidth:\"550px\",margin:\"0px auto\"}}>\n           <div style={{\n               display:\"flex\",\n               justifyContent:\"space-around\",\n               margin:\"18px 0px\",\n               borderBottom:\"1px solid grey\"\n           }}>\n               <div>\n                   <img style={{width:\"160px\",height:\"160px\",borderRadius:\"80px\"}}\n                   src={userProfile.user.pic}\n                   />\n               </div>\n               <div>\n                   <h4>{userProfile.user.name}</h4>\n                   <h5>{userProfile.user.email}</h5>\n                   <div style={{display:\"flex\",justifyContent:\"space-between\",width:\"108%\"}}>\n                       <h6>{userProfile.posts.length} posts</h6>\n                       <h6>{userProfile.user.followers.length} followers</h6>\n                       <h6>{userProfile.user.following.length} following</h6>\n                   </div>\n                   {showfollow?\n                   <button style={{\n                       margin:\"10px\"\n                   }} className=\"btn waves-effect waves-light #64b5f6 blue darken-1\"\n                    onClick={()=>followUser()}\n                    >\n                        Follow\n                    </button>\n                    : \n                    <button\n                    style={{\n                        margin:\"10px\"\n                    }}\n                    className=\"btn waves-effect waves-light #64b5f6 blue darken-1\"\n                    onClick={()=>unfollowUser()}\n                    >\n                        UnFollow\n                    </button>\n                    }\n                   \n                  \n\n               </div>\n           </div>\n     \n           <div className=\"gallery\">\n               {\n                   userProfile.posts.map(item=>{\n                       return(\n                        <img key={item._id} className=\"item\" src={item.photo} alt={item.title}/>  \n                       )\n                   })\n               }\n\n           \n           </div>\n       </div>\n       \n       \n       : <h2>loading...!</h2>}\n       \n       </>\n   )\n}\n\n\nexport default Profile"]},"metadata":{},"sourceType":"module"}
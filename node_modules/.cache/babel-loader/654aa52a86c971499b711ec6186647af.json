{"ast":null,"code":"import _objectSpread from\"/home/divyanshu/nodejs/instagram/server/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/home/divyanshu/nodejs/instagram/server/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState,useContext}from'react';import{UserContext}from'../../App';var Profile=function Profile(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),mypics=_useState2[0],setPics=_useState2[1];var _useContext=useContext(UserContext),state=_useContext.state,dispatch=_useContext.dispatch;var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),image=_useState4[0],setImage=_useState4[1];useEffect(function(){fetch('/mypost',{headers:{\"Authorization\":\"Bearer \"+localStorage.getItem(\"jwt\")}}).then(function(res){return res.json();}).then(function(result){console.log(result);setPics(result.mypost);});},[state]);useEffect(function(){if(image){var data=new FormData();data.append(\"file\",image);data.append(\"upload_preset\",\"insta-clone\");data.append(\"cloud_name\",\"dkinsta\");fetch(\"https://api.cloudinary.com/v1_1/dkinsta/image/upload\",{method:\"post\",body:data}).then(function(res){return res.json();}).then(function(data){fetch('/updatepic',{method:\"put\",headers:{\"Content-Type\":\"application/json\",\"Authorization\":\"Bearer \"+localStorage.getItem(\"jwt\")},body:JSON.stringify({pic:data.url})}).then(function(res){return res.json();}).then(function(result){console.log(result);localStorage.setItem(\"user\",JSON.stringify(_objectSpread({},state,{pic:result.pic})));dispatch({type:\"UPDATEPIC\",payload:result.pic});//window.location.reload()\n});}).catch(function(err){console.log(err);});}},[image]);var updatePhoto=function updatePhoto(file){setImage(file);};return/*#__PURE__*/React.createElement(\"div\",{style:{maxWidth:\"550px\",margin:\"0px auto\"}},/*#__PURE__*/React.createElement(\"div\",{style:{margin:\"18px 0px\",borderBottom:\"1px solid grey\"}},/*#__PURE__*/React.createElement(\"div\",{style:{display:\"flex\",justifyContent:\"space-around\"}},/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"img\",{style:{width:\"160px\",height:\"160px\",borderRadius:\"80px\"},src:state?state.pic:\"loading\"})),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"h4\",null,state?state.name:\"loading\"),/*#__PURE__*/React.createElement(\"h5\",null,state?state.email:\"loading\"),/*#__PURE__*/React.createElement(\"div\",{style:{display:\"flex\",justifyContent:\"space-between\",width:\"108%\"}},/*#__PURE__*/React.createElement(\"h6\",null,mypics.length,\" posts\"),console.log(\"helo\"),console.log(state),/*#__PURE__*/React.createElement(\"h6\",null,state?state.followers.length:\"0\",\" followers\"),/*#__PURE__*/React.createElement(\"h6\",null,state?state.following.length:\"0\",\" following\")))),/*#__PURE__*/React.createElement(\"div\",{className:\"file-field input-field\",style:{margin:\"10px\"}},/*#__PURE__*/React.createElement(\"div\",{className:\"btn #64b5f6 blue darken-1\"},/*#__PURE__*/React.createElement(\"span\",null,\"Update pic\"),/*#__PURE__*/React.createElement(\"input\",{type:\"file\",onChange:function onChange(e){return updatePhoto(e.target.files[0]);}})),/*#__PURE__*/React.createElement(\"div\",{className:\"file-path-wrapper\"},/*#__PURE__*/React.createElement(\"input\",{className:\"file-path validate\",type:\"text\"})))),/*#__PURE__*/React.createElement(\"div\",{className:\"gallery\"},mypics.map(function(item){return/*#__PURE__*/React.createElement(\"img\",{key:item._id,className:\"item\",src:item.photo,alt:item.title});})));};export default Profile;","map":{"version":3,"sources":["/home/divyanshu/nodejs/instagram/server/client/src/components/screens/Profile.js"],"names":["React","useEffect","useState","useContext","UserContext","Profile","mypics","setPics","state","dispatch","image","setImage","fetch","headers","localStorage","getItem","then","res","json","result","console","log","mypost","data","FormData","append","method","body","JSON","stringify","pic","url","setItem","type","payload","catch","err","updatePhoto","file","maxWidth","margin","borderBottom","display","justifyContent","width","height","borderRadius","name","email","length","followers","following","e","target","files","map","item","_id","photo","title"],"mappings":"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","sourcesContent":["import React,{useEffect,useState,useContext} from 'react'\nimport {UserContext} from '../../App'\n\nconst Profile  = ()=>{\n    const [mypics,setPics] = useState([])\n    const {state,dispatch} = useContext(UserContext)\n    const [image,setImage] = useState(\"\")\n    \n    useEffect(()=>{\n       fetch('/mypost',{\n           headers:{\n               \"Authorization\":\"Bearer \"+localStorage.getItem(\"jwt\")\n           }\n       }).then(res=>res.json())\n       .then(result=>{\n        \n           console.log(result)\n           setPics(result.mypost)\n       })\n    },[state])\n    useEffect(()=>{\n       if(image){\n        const data = new FormData()\n        data.append(\"file\",image)\n        data.append(\"upload_preset\",\"insta-clone\")\n        data.append(\"cloud_name\",\"dkinsta\")\n        fetch(\"https://api.cloudinary.com/v1_1/dkinsta/image/upload\",{\n            method:\"post\",\n            body:data\n        })\n        .then(res=>res.json())\n        .then(data=>{\n    \n       \n           fetch('/updatepic',{\n               method:\"put\",\n               headers:{\n                   \"Content-Type\":\"application/json\",\n                   \"Authorization\":\"Bearer \"+localStorage.getItem(\"jwt\")\n               },\n               body:JSON.stringify({\n                   pic:data.url\n               })\n           }).then(res=>res.json())\n           .then(result=>{\n          \n               console.log(result)\n               \n               localStorage.setItem(\"user\",JSON.stringify({...state,pic:result.pic}))\n               dispatch({type:\"UPDATEPIC\",payload:result.pic})\n               //window.location.reload()\n           })\n       \n        })\n        .catch(err=>{\n            console.log(err)\n        })\n       }\n    },[image])\n    const updatePhoto = (file)=>{\n        setImage(file)\n    }\n \n   return (\n       <div style={{maxWidth:\"550px\",margin:\"0px auto\"}}>\n           <div style={{\n              margin:\"18px 0px\",\n               borderBottom:\"1px solid grey\"\n           }}>\n\n         \n           <div style={{\n               display:\"flex\",\n               justifyContent:\"space-around\",\n              \n           }}>\n               <div>\n                   <img style={{width:\"160px\",height:\"160px\",borderRadius:\"80px\"}}\n                   src={state?state.pic:\"loading\"}\n                   />\n                 \n               </div>\n               <div>\n                   <h4>{state?state.name:\"loading\"}</h4>\n                   <h5>{state?state.email:\"loading\"}</h5>\n                   <div style={{display:\"flex\",justifyContent:\"space-between\",width:\"108%\"}}>\n                       \n                       <h6>{mypics.length} posts</h6>\n                       {\n                           console.log(\"helo\")\n                           \n                       }\n                       {console.log(state)}\n                       <h6>{state?state.followers.length:\"0\"} followers</h6>\n                       <h6>{state?state.following.length:\"0\"} following</h6>\n                   </div>\n\n               </div>\n           </div>\n        \n            <div className=\"file-field input-field\" style={{margin:\"10px\"}}>\n            <div className=\"btn #64b5f6 blue darken-1\">\n                <span>Update pic</span>\n                <input type=\"file\" onChange={(e)=>updatePhoto(e.target.files[0])} />\n            </div>\n            <div className=\"file-path-wrapper\">\n                <input className=\"file-path validate\" type=\"text\" />\n            </div>\n            </div>\n            </div>      \n           <div className=\"gallery\">\n               {\n                   mypics.map(item=>{\n                       return(\n                        <img key={item._id} className=\"item\" src={item.photo} alt={item.title}/>  \n                       )\n                   })\n               }\n\n           \n           </div>\n       </div>\n   )\n}\n\n\nexport default Profile"]},"metadata":{},"sourceType":"module"}